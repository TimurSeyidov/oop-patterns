# Паттерн неизменяемый интерфейс(Immutable interface)

---

## Автор:

Хайруллин Ильнур Рустемович

---

**_Интерпретатор_** — это шаблон проектирования, который позволяет выполнять операции над объектами, используя специальный язык или грамматику. Он решает проблему интерпретации и выполнения команд, заданных в текстовом формате.

### Свойства

- Включает в себя реализацию интерфейса выражения, который указывает интерпретировать конкретный контекст.

- Используется в синтаксическом анализе SQL, механизме обработки символов и т. д.

- Работает с иерархией выражений. Каждое выражение здесь является терминальным или нетерминальным.

- Древовидная структура шаблона проектирования интерпретатора в чем-то похожа на структуру, определяемую составным шаблоном проектирования, где терминальные выражения являются конечными объектами, а нетерминальные выражения являются составными.

- Дерево содержит выражения, подлежащие оценке, и обычно создается синтаксическим анализатором. Сам синтаксический анализатор не является частью шаблона интерпретатора.

---

# Проблема

Проблема, которую решает этот шаблон, заключается в том, что иногда требуется интерпретировать выражения, которые не могут быть представлены в виде дерева объектов. Например, если нужно вычислить значение выражения "2 + 3 \* 4", то это можно сделать, используя дерево объектов операций и значений. Однако, если нужно интерпретировать выражение на естественном языке, то дерево объектов уже не подходит.

---

# Решение

Для решения этой проблемы можно использовать шаблон проектирования Интерпретатор. В рамках этого шаблона грамматика языка описывается в виде классов, а каждый класс отвечает за интерпретацию определенного типа выражений. Например, для интерпретации выражения "2 + 3 \* 4" можно создать классы для операций сложения и умножения, а также класс для представления чисел:
![](https://media.geeksforgeeks.org/wp-content/uploads/UMLDiagram-1.png)

AbstractExpression (Expression): объявляет операцию интерпретировать(), которую переопределяют все узлы (терминальные и нетерминальные) в AST.
TerminalExpression (NumberExpression): реализует операцию интерпретировать() для терминальных выражений.
NonterminalExpression (AdditionExpression, SubtractionExpression и MultiplicationExpression): реализует операцию интерпретировать() для всех нетерминальных выражений.
Контекст (строка): содержит информацию, глобальную для интерпретатора. Именно это строковое выражение с нотацией Postfix необходимо интерпретировать и анализировать.
Клиент (ExpressionParser): создает (или предоставляет) AST, собранный из TerminalExpression и NonTerminalExpression. Клиент вызывает операцию интерпретировать().

---

# Пример кода:

```
interface Expression {
    int interpret();
}

class Number implements Expression {
    private int value;

    public Number(int value) {
        this.value = value;
    }

    public int interpret() {
        return value;
    }
}

class Add implements Expression {
    private Expression left;
    private Expression right;

    public Add(Expression left, Expression right) {
        this.left = left;
        this.right = right;
    }

    public int interpret() {
        return left.interpret() + right.interpret();
    }
}

class Multiply implements Expression {
    private Expression left;
    private Expression right;

    public Multiply(Expression left, Expression right) {
        this.left = left;
        this.right = right;
    }

    public int interpret() {
        return left.interpret() * right.interpret();
    }
}

public class InterpreterExample {
    public static void main(String[] args) {
        Expression expression = new Add(
                new Number(2),
                new Multiply(
                        new Number(3),
                        new Number(4)
                )
        );
        System.out.println(expression.interpret()); // Output: 14
    }
}

```

# Преимущества и недостатки

### Преимущества

1. Позволяет создавать гибкие и расширяемые системы, которые могут легко адаптироваться к изменяющимся требованиям.

2. Упрощает интерпретацию и выполнение команд, заданных в текстовом формате.

3. Облегчает работу с различными языками и грамматиками.

### Недостатки

1. Может быть сложным для понимания и использования, особенно для новых разработчиков.

2. Может привести к увеличению сложности кода и ухудшению производительности.

3. Не подходит для всех типов задач и проектов.
